include/rpl_init.inc [topology=none]
*** Configuring connections ***
include/rpl_connect.inc [creating srv_primary]
include/rpl_connect.inc [creating srv_primary1]
include/rpl_connect.inc [creating srv_primary2]
include/rpl_connect.inc [creating srv_replica]
include/rpl_connect.inc [creating srv_replica1]
include/rpl_connect.inc [creating srv_replica2]
*** Waiting for each cluster to startup ***
*** Configuring replication via Replica ***
[connection srv_replica]
include/rpl_change_topology.inc [new topology=1->4]
include/start_replica.inc
*** Generating replica cluster originated binloggable changes ***
CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_logged_1;
CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_logged_2;
CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_logged_3;
***Generating replica cluster non-binloggable changes***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Generating data to be replicated ***
CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_1 VALUES (1);
DROP TABLE bug45756_primary_logged_1;
CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_2 VALUES (1);
DROP TABLE bug45756_primary_logged_2;
CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_3 VALUES (1);
DROP TABLE bug45756_primary_logged_3;
*** Generating changes not to be replicated ***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_1 VALUES (1);
DROP TABLE bug45756_primary_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_2 VALUES (1);
DROP TABLE bug45756_primary_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_3 VALUES (1);
DROP TABLE bug45756_primary_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Checking binlog contents on every server in both clusters ***



connection srv_primary;
show variables like 'server_id';
Variable_name	Value
server_id	1
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_1` /* generated by server */
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 



connection srv_primary1;
show variables like 'server_id';
Variable_name	Value
server_id	2
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_primary2;
show variables like 'server_id';
Variable_name	Value
server_id	3
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_1`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; DROP TABLE `bug45756_primary_logged_3` /* generated by server */
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 



connection srv_replica;
show variables like 'server_id';
Variable_name	Value
server_id	4
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_replica1;
show variables like 'server_id';
Variable_name	Value
server_id	5
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; DROP TABLE `bug_45756_replica_logged_2` /* generated by server */
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 



connection srv_replica2;
show variables like 'server_id';
Variable_name	Value
server_id	6
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	ON
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_2`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; DROP TABLE `bug_45756_replica_logged_3` /* generated by server */
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_1`
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
include/stop_replica.inc
*** Configuring replication via Replica1 ***
[connection srv_replica1]
include/rpl_change_topology.inc [new topology=1->4,1->5]
include/start_replica.inc
*** Generating replica cluster originated binloggable changes ***
CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_logged_1;
CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_logged_2;
CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_logged_3;
***Generating replica cluster non-binloggable changes***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Generating data to be replicated ***
CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_1 VALUES (1);
DROP TABLE bug45756_primary_logged_1;
CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_2 VALUES (1);
DROP TABLE bug45756_primary_logged_2;
CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_3 VALUES (1);
DROP TABLE bug45756_primary_logged_3;
*** Generating changes not to be replicated ***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_1 VALUES (1);
DROP TABLE bug45756_primary_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_2 VALUES (1);
DROP TABLE bug45756_primary_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_3 VALUES (1);
DROP TABLE bug45756_primary_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Checking binlog contents on every server in both clusters ***



connection srv_primary;
show variables like 'server_id';
Variable_name	Value
server_id	1
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_1` /* generated by server */
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 



connection srv_primary1;
show variables like 'server_id';
Variable_name	Value
server_id	2
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_primary2;
show variables like 'server_id';
Variable_name	Value
server_id	3
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_1`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; DROP TABLE `bug45756_primary_logged_3` /* generated by server */
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 



connection srv_replica;
show variables like 'server_id';
Variable_name	Value
server_id	4
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_replica1;
show variables like 'server_id';
Variable_name	Value
server_id	5
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; DROP TABLE `bug_45756_replica_logged_2` /* generated by server */
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 



connection srv_replica2;
show variables like 'server_id';
Variable_name	Value
server_id	6
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	ON
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_2`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; DROP TABLE `bug_45756_replica_logged_3` /* generated by server */
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_1`
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483521    	Query	 	 	 
include/stop_replica.inc
*** Configuring replication via Replica2 ***
[connection srv_replica2]
include/rpl_change_topology.inc [new topology=1->4,1->5,1->6]
include/start_replica.inc
*** Generating replica cluster originated binloggable changes ***
CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_logged_1;
CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_logged_2;
CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_logged_3;
***Generating replica cluster non-binloggable changes***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_1 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_1 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_2 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_2 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug_45756_replica_not_logged_3 (a int) engine = NDB;
INSERT INTO bug_45756_replica_not_logged_3 VALUES (1);
DROP TABLE bug_45756_replica_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Generating data to be replicated ***
CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_1 VALUES (1);
DROP TABLE bug45756_primary_logged_1;
CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_2 VALUES (1);
DROP TABLE bug45756_primary_logged_2;
CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_logged_3 VALUES (1);
DROP TABLE bug45756_primary_logged_3;
*** Generating changes not to be replicated ***
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_1 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_1 VALUES (1);
DROP TABLE bug45756_primary_not_logged_1;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_2 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_2 VALUES (1);
DROP TABLE bug45756_primary_not_logged_2;
SET SQL_LOG_BIN= 1;
SET SQL_LOG_BIN= 0;
CREATE TABLE bug45756_primary_not_logged_3 (a int) engine = NDB;
INSERT INTO bug45756_primary_not_logged_3 VALUES (1);
DROP TABLE bug45756_primary_not_logged_3;
SET SQL_LOG_BIN= 1;
*** Checking binlog contents on every server in both clusters ***



connection srv_primary;
show variables like 'server_id';
Variable_name	Value
server_id	1
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_1` /* generated by server */
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	1	#	BEGIN
primary-bin.000001	#	Table_map	1	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	1	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	1	#	table_id: #
primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	1	#	COMMIT
primary-bin.000001	#	Query	1	#	use `test`; drop table `test`.`bug45756_primary_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 2147483521    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 1    	Table_map: `mysql`.`ndb_apply_status`  
server id 1    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 1    	Query	 	 	 
server id 2147483521    	Query	 	 	 



connection srv_primary1;
show variables like 'server_id';
Variable_name	Value
server_id	2
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_primary2;
show variables like 'server_id';
Variable_name	Value
server_id	3
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_1)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_1`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_2)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; drop table `test`.`bug45756_primary_logged_2`
primary-bin.000001	#	Query	3	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
primary-bin.000001	#	Query	3	#	BEGIN
primary-bin.000001	#	Table_map	3	#	table_id: # (test.bug45756_primary_logged_3)
primary-bin.000001	#	Table_map	3	#	table_id: # (mysql.ndb_apply_status)
primary-bin.000001	#	Write_rows	3	#	table_id: #
primary-bin.000001	#	Write_rows	3	#	table_id: # flags: STMT_END_F
primary-bin.000001	#	Query	3	#	COMMIT
primary-bin.000001	#	Query	3	#	use `test`; DROP TABLE `bug45756_primary_logged_3` /* generated by server */
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 2147483523    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 
server id 3    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 3    	Table_map: `mysql`.`ndb_apply_status`  
server id 3    	Write_rows:  
server id 2147483523    	Write_rows:   flags: STMT_END_F
server id 3    	Query	 	 	 
server id 3    	Query	 	 	 



connection srv_replica;
show variables like 'server_id';
Variable_name	Value
server_id	4
show variables like 'log_bin';
Variable_name	Value
log_bin	OFF
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info



connection srv_replica1;
show variables like 'server_id';
Variable_name	Value
server_id	5
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	OFF
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; DROP TABLE `bug_45756_replica_logged_2` /* generated by server */
replica-primary-bin.000001	#	Query	5	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	5	#	BEGIN
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	5	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	5	#	table_id: #
replica-primary-bin.000001	#	Write_rows	5	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	5	#	COMMIT
replica-primary-bin.000001	#	Query	5	#	use `test`; drop table `test`.`bug_45756_replica_logged_3`
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 
server id 5    	Query	 	 	 
server id 5    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 5    	Table_map: `mysql`.`ndb_apply_status`  
server id 5    	Write_rows:  
server id 2147483525    	Write_rows:   flags: STMT_END_F
server id 5    	Query	 	 	 
server id 2147483525    	Query	 	 	 



connection srv_replica2;
show variables like 'server_id';
Variable_name	Value
server_id	6
show variables like 'log_bin';
Variable_name	Value
log_bin	ON
show variables like 'log_replica_updates';
Variable_name	Value
log_replica_updates	ON
show binlog events from <binlog_start>;
Log_name	Pos	Event_type	Server_id	End_log_pos	Info
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_1`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; drop table `test`.`bug_45756_replica_logged_2`
replica-primary-bin.000001	#	Query	6	#	use `test`; CREATE TABLE bug_45756_replica_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug_45756_replica_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	6	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	6	#	use `test`; DROP TABLE `bug_45756_replica_logged_3` /* generated by server */
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_1 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_1)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_1` /* generated by server */
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_2 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_2)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_2` /* generated by server */
replica-primary-bin.000001	#	Query	1	#	use `test`; CREATE TABLE bug45756_primary_logged_3 (a int) engine = NDB
replica-primary-bin.000001	#	Query	6	#	BEGIN
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (test.bug45756_primary_logged_3)
replica-primary-bin.000001	#	Table_map	6	#	table_id: # (mysql.ndb_apply_status)
replica-primary-bin.000001	#	Write_rows	6	#	table_id: #
replica-primary-bin.000001	#	Write_rows	1	#	table_id: # flags: STMT_END_F
replica-primary-bin.000001	#	Query	6	#	COMMIT
replica-primary-bin.000001	#	Query	1	#	use `test`; DROP TABLE `bug45756_primary_logged_3` /* generated by server */
select replace(right(txt, length(txt)-17), '\r', '') as binlog_entries from raw_binlog_rows where txt like '%server id%' and not (txt like '%Start%' or txt like '%Rotate%');
binlog_entries
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 2147483526    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug_45756_replica_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483526    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 6    	Query	 	 	 
server id 1    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_1`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_2`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 1    	Query	 	 	 
server id 1    	Query	 	 	 
server id 6    	Query	 	 	 
server id 6    	Table_map: `test`.`bug45756_primary_logged_3`  
server id 6    	Table_map: `mysql`.`ndb_apply_status`  
server id 6    	Write_rows:  
server id 2147483521    	Write_rows:   flags: STMT_END_F
server id 6    	Query	 	 	 
server id 1    	Query	 	 	 
include/stop_replica.inc
include/rpl_change_topology.inc [new topology=none]
