#########################################################################
# Verify RESET REPLICA and RESET REPLICA FOR CHANNEL
# - deletes all relay log files of named channels.
# - For default channel, it restart the relay log from .000001
#########################################################################
include/primary-replica.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the primary info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
[connection primary]
[connection replica]
CHANGE PRIMARY TO PRIMARY_HOST="localhost", PRIMARY_PORT=10 FOR CHANNEL "ch1";
CHANGE PRIMARY TO PRIMARY_HOST="localhost", PRIMARY_PORT=11 FOR CHANNEL "ch2";
FLUSH RELAY LOGS;
FLUSH RELAY LOGS FOR CHANNEL "ch1";
FLUSH RELAY LOGS FOR CHANNEL "ch2";
#
# RESET REPLICA FOR CHANNEL "ch1" deletes all relay log files of ch1.
#
RESET REPLICA FOR CHANNEL "ch1";
#
# RESET REPLICA deletes all relay log files of ch2
#
include/stop_replica.inc
RESET REPLICA;
#
# RESET REPLICA resets relay log of default channel from .000001
#
#
# Recreate channels "ch1" and "ch2" files again.
#
CHANGE PRIMARY TO PRIMARY_HOST="localhost", PRIMARY_PORT=10 FOR CHANNEL "ch1";
CHANGE PRIMARY TO PRIMARY_HOST="localhost", PRIMARY_PORT=11 FOR CHANNEL "ch2";
#
# RESET REPLICA ALL deletes all channels info and files.
#
RESET REPLICA ALL;
CHANGE PRIMARY TO PRIMARY_HOST="127.0.0.1", PRIMARY_PORT=PRIMARY_PORT,
PRIMARY_USER="root";
include/start_replica.inc
include/rpl_end.inc
