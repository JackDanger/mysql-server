include/primary-replica.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the primary info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
[connection primary]
==== If server with replicate-same-server-id is replica of itself, it executes transactions twice ====
---- Initialize ----
[connection replica]
CREATE TABLE t1 (n INT);
RESET PRIMARY;
include/stop_replica.inc
CHANGE PRIMARY TO PRIMARY_PORT = REPLICA_PORT;
include/start_replica.inc
---- Test ----
INSERT INTO t1 VALUES (1);
SELECT * FROM t1;
n
1
1
---- Clean up ----
include/stop_replica.inc
DROP TABLE t1;
CHANGE PRIMARY TO PRIMARY_PORT = PRIMARY_PORT;
==== START REPLICA UNTIL works with replicate-same-server-id ====
---- Initialize ----
[connection primary]
CREATE TABLE t1(n int);
CREATE TABLE t2(n int);
---- Test ----
[connection replica]
START REPLICA UNTIL PRIMARY_LOG_FILE = 'primary-bin.000001', PRIMARY_LOG_POS = UNTIL_POS;
include/wait_for_replica_io_to_start.inc
include/wait_for_replica_sql_to_stop.inc
include/assert.inc [t1 should be replicated, t2 should not]
---- Clean up ----
[connection replica]
include/start_replica_sql.inc
[connection primary]
DROP TABLE t1;
DROP TABLE t2;
include/rpl_end.inc
