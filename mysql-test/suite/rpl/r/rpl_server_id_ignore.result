include/primary-replica.inc
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the primary info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
[connection primary]
primary_id: 1
stop replica;
*** --replicate-same-server-id and change primary option can clash ***
change primary to IGNORE_SERVER_IDS= (2, 1);
ERROR HY000: The requested server id 2 clashes with the replica startup option --replicate-same-server-id
*** must be empty due to the error ***
ignore server id list: 
change primary to IGNORE_SERVER_IDS= (10, 100);
*** must be 10, 100 ***
ignore server id list: 10, 100
reset replica;
*** must be still (10,100) after reset replica ***
ignore server id list: 10, 100
change primary to IGNORE_SERVER_IDS= (10, 100);
*** CHANGE PRIMARY with IGNORE_SERVER_IDS option overrides (does not increment) the previous setup ***
change primary to IGNORE_SERVER_IDS= (5, 1, 4, 3, 1);
*** must be 1, 3, 4, 5 due to overriding policy ***
ignore server id list: 1, 3, 4, 5
*** ignore primary (server 1) queries for a while ***
include/start_replica.inc
include/sync_replica_sql_with_primary.inc
create table t1 (n int);
include/wait_for_replica_param.inc [Exec_Primary_Log_Pos]
*** must be empty as the event is to be filtered out ***
show tables;
Tables_in_test
*** allowing events from primary ***
stop replica;
include/wait_for_replica_to_stop.inc
reset replica;
change primary to IGNORE_SERVER_IDS= (10, 100);
*** the list must remain (10, 100) after reset replica ***
change primary to IGNORE_SERVER_IDS= ();
*** must be empty due to IGNORE_SERVER_IDS empty list ***
ignore server id list: 
*** RESET REPLICA ALL should empty the list ***
CHANGE PRIMARY TO IGNORE_SERVER_IDS= (10, 100);
ignore server id list: 10, 100
RESET REPLICA ALL;
change primary to primary_host='127.0.0.1', primary_port=PRIMARY_PORT, primary_user='root';
Warnings:
Note	####	Sending passwords in plain text without SSL/TLS is extremely insecure.
Note	####	Storing MySQL user name or password information in the primary info repository is not secure and is therefore not recommended. Please consider using the USER and PASSWORD connection options for START REPLICA; see the 'START REPLICA Syntax' in the MySQL Manual for more information.
include/start_replica.inc
include/assert.inc [RESET REPLICA ALL must empty the list of server-ids.]
include/sync_replica_sql_with_primary.inc
*** must have caught create table ***
show tables;
Tables_in_test
t1
drop table t1;
include/sync_replica_sql_with_primary.inc
# === Bug#18192817 IGNORE_SERVER_IDS IS SHOWING DUPLICATE SERVER IDS ===
include/stop_replica.inc
The list should have 0 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = ''
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420);
The list should have 4 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 220, 330, 420'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420), IGNORE_SERVER_IDS= (110,220,330,420);
The list should still have only 4 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 220, 330, 420'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

ISSUE WAS HERE: All server ids should be stored and showed only once, while they are set twice or even more.
The list should have 5 elements.
CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420), IGNORE_SERVER_IDS= (111,220,330,420);
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 111, 220, 330, 420'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420), IGNORE_SERVER_IDS= (111,221,330,420);
The list should have 6 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 111, 220, 221, 330, 420'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420), IGNORE_SERVER_IDS= (111,221,331,420);
The list should have 7 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 111, 220, 221, 330, 331, 420'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= (110,220,330,420), IGNORE_SERVER_IDS= (111,221,331,421);
The list should have 8 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '110, 111, 220, 221, 330, 331, 420, 421'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

CHANGE PRIMARY TO IGNORE_SERVER_IDS= ();
The list should have NO elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = ''
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

# === Bug #18593479: ON PRIMARY_INFO_REPOSITORY CHANGE, ===
# === IGNORE_SERVER_IDS DOUBLES WITH DUP VALUES        ===
SET GLOBAL primary_info_repository= 'FILE';
CHANGE PRIMARY TO IGNORE_SERVER_IDS= (5,10,15);
include/start_replica.inc
Expect 3 elements.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '5, 10, 15'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

include/stop_replica.inc
SET GLOBAL primary_info_repository= 'TABLE';
include/start_replica.inc

ISSUE WAS HERE: Due to buggy behaviour, we woule see 6 elements here.
Expect 3 elements ONLY to verify the fix when changing from FILE->TABLE.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '5, 10, 15'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

include/stop_replica.inc
SET GLOBAL primary_info_repository= 'FILE';
include/start_replica.inc

ISSUE WAS HERE TOO: Due to buggy behaviour, we woule see 12 elements here.
Expect 3 elements ONLY to verify the fix when changinf from TABLE->FILE.
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.
Replicate_Ignore_Server_Ids = '5, 10, 15'
Warnings:
Warning	3090	Changing sql mode 'NO_AUTO_CREATE_USER' is deprecated. It will be removed in a future release.

include/stop_replica.inc
CHANGE PRIMARY TO IGNORE_SERVER_IDS= ();
include/start_replica.inc
include/rpl_end.inc
