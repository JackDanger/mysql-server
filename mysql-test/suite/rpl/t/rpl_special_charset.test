################################################################################
# Bug#19855907 IO THREAD AUTHENTICATION ISSUE WITH SOME CHARACTER SETS
# Problem: IO thread fails to connect to primary if servers are configured with
#  special character sets like utf16, utf32, ucs2.
#
# Analysis: MySQL server does not support few special character sets like
#  utf16,utf32 and ucs2 as "client's character set"(eg: utf16,utf32, ucs2).
#  When IO thread is trying to connect to Primary, it sets server's character
#  set as client's character set. When Replica server is started with these
#  special character sets, IO thread (a connection to Primary) fails because
#  of the above said reason.
#
# Fix: If server's character set is not supported as client's character set,
#  then set default's client character set(latin1) as client's character set.
###############################################################################
--source include/not_group_replication_plugin.inc
--source include/primary-replica.inc
CREATE TABLE t1(i VARCHAR(20));
INSERT INTO t1 VALUES (0xFFFF);
--sync_replica_with_primary
--let diff_tables=primary:t1, replica:t1
--source include/diff_tables.inc
# Cleanup
--connection primary
DROP TABLE t1;
--source include/rpl_end.inc
